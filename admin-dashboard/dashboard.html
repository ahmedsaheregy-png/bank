<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة تحكم الأدمن - SAWYAN BANK</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700;800&family=Tajawal:wght@400;500;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../shared/css/variables.css">
    <link rel="stylesheet" href="../shared/css/logo.css">
    <link rel="stylesheet" href="../member-dashboard/css/dashboard.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="css/admin_mobile_tables.css">
</head>

<body>
    <div class="dashboard-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div id="logoContainer"></div>
            </div>

            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-page="home">
                    <span class="icon">🏠</span>
                    <span>الرئيسية</span>
                </a>
                <a href="#" class="nav-item" data-page="members">
                    <span class="icon">👥</span>
                    <span>الأعضاء</span>
                </a>
                <a href="#" class="nav-item" data-page="merchants">
                    <span class="icon">🏪</span>
                    <span>التجار</span>
                </a>
                <a href="#" class="nav-item" data-page="transactions">
                    <span class="icon">💳</span>
                    <span>العمليات</span>
                </a>
                <a href="#" class="nav-item" data-page="commissions">
                    <span class="icon">💰</span>
                    <span>العمولات</span>
                </a>
                <a href="#" class="nav-item" data-page="disputes">
                    <span class="icon">⚠️</span>
                    <span>الشكاوى</span>
                </a>
                <a href="#" class="nav-item" data-page="support">
                    <span class="icon">🎫</span>
                    <span>الدعم الفني</span>
                </a>
                <a href="#" class="nav-item" data-page="reports">
                    <span class="icon">📊</span>
                    <span>التقارير</span>
                </a>
                <a href="#" class="nav-item" data-page="withdrawals">
                    <span class="icon">💸</span>
                    <span>طلبات السحب</span>
                </a>
                <a href="#" class="nav-item" data-page="settings">
                    <span class="icon">⚙️</span>
                    <span>الإعدادات</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <button class="btn btn-outline btn-block" onclick="logout()">تسجيل الخروج</button>
            </div>
        </aside>

        <main class="main-content">
            <header class="dashboard-header">
                <h1 id="pageTitle">لوحة تحكم الأدمن</h1>
                <div class="user-info">
                    <span id="adminName">مدير النظام</span>
                    <span class="member-code">Super Admin</span>
                </div>
            </header>

            <div class="content-area" id="contentArea">
                <!-- Home Page -->
                <div id="homePage" class="page active">
                    <div class="stats-grid">
                        <div class="stat-card stat-primary">
                            <div class="stat-icon">👥</div>
                            <div class="stat-info">
                                <div class="stat-label">إجمالي الأعضاء</div>
                                <div class="stat-value" id="totalMembers">0</div>
                            </div>
                        </div>

                        <div class="stat-card stat-success">
                            <div class="stat-icon">🏪</div>
                            <div class="stat-info">
                                <div class="stat-label">إجمالي التجار</div>
                                <div class="stat-value" id="totalMerchants">0</div>
                            </div>
                        </div>

                        <div class="stat-card stat-info">
                            <div class="stat-icon">💳</div>
                            <div class="stat-info">
                                <div class="stat-label">إجمالي العمليات</div>
                                <div class="stat-value" id="totalTransactions">0</div>
                            </div>
                        </div>

                        <div class="stat-card stat-warning">
                            <div class="stat-icon">💰</div>
                            <div class="stat-info">
                                <div class="stat-label">إجمالي العمولات</div>
                                <div class="stat-value" id="totalCommissions">0 ج.م</div>
                            </div>
                        </div>
                    </div>

                    <div class="charts-grid">
                        <div class="chart-card">
                            <h3>العمليات اليومية (آخر 7 أيام)</h3>
                            <div id="dailyChart" class="chart-placeholder">
                                <p>الرسم البياني سيظهر هنا</p>
                            </div>
                        </div>

                        <div class="chart-card">
                            <h3>التوزيع حسب الفئات</h3>
                            <div id="categoryChart" class="chart-placeholder">
                                <p>الرسم البياني سيظهر هنا</p>
                            </div>
                        </div>
                    </div>

                    <div class="recent-activity">
                        <h2>النشاط الأخير</h2>
                        <div id="activityList" class="activity-list"></div>
                    </div>
                </div>

                <!-- Members Page -->
                <div id="membersPage" class="page">
                    <div class="page-header">
                        <h2>إدارة الأعضاء</h2>
                        <button class="btn btn-primary" onclick="exportMembers()">تصدير Excel</button>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="membersTable">
                            <thead>
                                <tr>
                                    <th>كود العضوية</th>
                                    <th>الاسم</th>
                                    <th>البريد الإلكتروني</th>
                                    <th>الموبايل</th>
                                    <th>تاريخ التسجيل</th>
                                    <th>الحالة</th>
                                    <th>إجراءات</th>
                                </tr>
                            </thead>
                            <tbody id="membersTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Merchants Page -->
                <div id="merchantsPage" class="page">
                    <div class="page-header">
                        <h2>إدارة التجار</h2>
                        <button class="btn btn-primary" onclick="exportMerchants()">تصدير Excel</button>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="merchantsTable">
                            <thead>
                                <tr>
                                    <th>كود التاجر</th>
                                    <th>اسم النشاط</th>
                                    <th>النوع</th>
                                    <th>الفئة</th>
                                    <th>النسبة %</th>
                                    <th>المستحقات</th>
                                    <th>الحالة</th>
                                    <th>إجراءات</th>
                                </tr>
                            </thead>
                            <tbody id="merchantsTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Transactions Page -->
                <div id="transactionsPage" class="page">
                    <div class="page-header">
                        <h2>جميع العمليات</h2>
                        <button class="btn btn-primary" onclick="exportTransactions()">تصدير Excel</button>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="transactionsTable">
                            <thead>
                                <tr>
                                    <th>كود العملية</th>
                                    <th>العضو</th>
                                    <th>التاجر</th>
                                    <th>المبلغ</th>
                                    <th>العمولة</th>
                                    <th>التاريخ</th>
                                    <th>الحالة</th>
                                </tr>
                            </thead>
                            <tbody id="transactionsTableBody"></tbody>
                        </table>
                    </div>
                </div>
                <!-- Commissions Page -->
                <div id="commissionsPage" class="page">
                    <div class="page-header">
                        <h2>إدارة العمولات</h2>
                        <button class="btn btn-primary" onclick="exportCommissions()">تصدير Excel</button>
                    </div>
                    <div class="stats-grid" style="margin-bottom: 2rem;">
                        <div class="stat-card stat-success">
                            <div class="stat-icon">💰</div>
                            <div class="stat-info">
                                <div class="stat-label">إجمالي العمولات</div>
                                <div class="stat-value" id="totalCommissionsAmount">0 ج.م</div>
                            </div>
                        </div>
                        <div class="stat-card stat-info">
                            <div class="stat-icon">📊</div>
                            <div class="stat-info">
                                <div class="stat-label">عمولات هذا الشهر</div>
                                <div class="stat-value" id="monthCommissions">0 ج.م</div>
                            </div>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="commissionsTable">
                            <thead>
                                <tr>
                                    <th>التاجر</th>
                                    <th>إجمالي العمليات</th>
                                    <th>إجمالي المبيعات</th>
                                    <th>إجمالي العمولات</th>
                                    <th>النسبة %</th>
                                </tr>
                            </thead>
                            <tbody id="commissionsTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Disputes Page -->
                <div id="disputesPage" class="page">
                    <div class="page-header">
                        <h2>إدارة الشكاوى والنزاعات</h2>
                        <button class="btn btn-primary" onclick="exportDisputes()">تصدير Excel</button>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="disputesTable">
                            <thead>
                                <tr>
                                    <th>كود الشكوى</th>
                                    <th>العملية</th>
                                    <th>العضو</th>
                                    <th>التاجر</th>
                                    <th>السبب</th>
                                    <th>التاريخ</th>
                                    <th>الحالة</th>
                                    <th>إجراءات</th>
                                </tr>
                            </thead>
                            <tbody id="disputesTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Support Page -->
                <div id="supportPage" class="page">
                    <div class="page-header">
                        <h2>طلبات الدعم الفني</h2>
                        <button class="btn btn-primary" onclick="exportSupport()">تصدير Excel</button>
                    </div>
                    <div class="table-container">
                        <table class="data-table" id="supportTable">
                            <thead>
                                <tr>
                                    <th>كود التذكرة</th>
                                    <th>المستخدم</th>
                                    <th>النوع</th>
                                    <th>الموضوع</th>
                                    <th>الأولوية</th>
                                    <th>التاريخ</th>
                                    <th>الحالة</th>
                                    <th>إجراءات</th>
                                </tr>
                            </thead>
                            <tbody id="supportTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Reports Page -->
                <div id="reportsPage" class="page">
                    <div class="page-header">
                        <h2>التقارير والإحصائيات</h2>
                    </div>

                    <div class="report-filters"
                        style="background: var(--surface-color); padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem;">
                        <h3 style="margin-bottom: 1rem;">فلترة التقارير</h3>
                        <div
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            <div>
                                <label>من تاريخ</label>
                                <input type="date" id="reportStartDate" class="form-control">
                            </div>
                            <div>
                                <label>إلى تاريخ</label>
                                <input type="date" id="reportEndDate" class="form-control">
                            </div>
                            <div>
                                <label>نوع التقرير</label>
                                <select id="reportType" class="form-control">
                                    <option value="all">جميع التقارير</option>
                                    <option value="transactions">تقرير العمليات</option>
                                    <option value="commissions">تقرير العمولات</option>
                                    <option value="members">تقرير الأعضاء</option>
                                    <option value="merchants">تقرير التجار</option>
                                </select>
                            </div>
                            <div style="display: flex; align-items: flex-end;">
                                <button class="btn btn-primary btn-block" onclick="generateReport()">إنشاء
                                    التقرير</button>
                            </div>
                        </div>
                    </div>

                    <div id="reportResults" class="report-results">
                        <p class="empty-state">اختر نوع التقرير والفترة الزمنية ثم اضغط على "إنشاء التقرير"</p>
                    </div>
                </div>

                <!-- Withdrawals Page -->
                <div id="withdrawalsPage" class="page">
                    <div class="page-header">
                        <h2>💸 طلبات السحب</h2>
                    </div>
                    <div id="withdrawalsContent">
                        <p class="empty-state">جاري تحميل طلبات السحب...</p>
                    </div>
                </div>

                <!-- Settings Page -->
                <div id="settingsPage" class="page">
                    <div class="page-header">
                        <h2>إعدادات النظام</h2>
                    </div>

                    <div class="settings-container">
                        <div class="settings-section">
                            <h3>إعدادات العمولات</h3>
                            <div class="form-group">
                                <label>نسبة العمولة الافتراضية (%)</label>
                                <input type="number" id="defaultCommission" class="form-control" step="0.1" min="0"
                                    max="100">
                            </div>
                            <div class="form-group">
                                <label>الحد الأدنى للعمولة (ج.م)</label>
                                <input type="number" id="minCommission" class="form-control" step="0.01" min="0">
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>إعدادات النظام</h3>
                            <div class="form-group">
                                <label>اسم النظام</label>
                                <input type="text" id="systemName" class="form-control" value="SAWYAN BANK">
                            </div>
                            <div class="form-group">
                                <label>بريد الدعم الفني</label>
                                <input type="email" id="supportEmail" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>رقم الدعم الفني</label>
                                <input type="tel" id="supportPhone" class="form-control">
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>إدارة المديرين</h3>
                            <button class="btn btn-primary" onclick="addNewAdmin()">إضافة مدير جديد</button>
                            <div class="table-container" style="margin-top: 1rem;">
                                <table class="data-table" id="adminsTable">
                                    <thead>
                                        <tr>
                                            <th>الاسم</th>
                                            <th>البريد الإلكتروني</th>
                                            <th>الصلاحيات</th>
                                            <th>الحالة</th>
                                            <th>إجراءات</th>
                                        </tr>
                                    </thead>
                                    <tbody id="adminsTableBody"></tbody>
                                </table>
                            </div>
                        </div>

                        <div class="settings-actions"
                            style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: flex-end;">
                            <button class="btn btn-outline" onclick="resetSettings()">إعادة تعيين</button>
                            <button class="btn btn-primary" onclick="saveSettings()">حفظ الإعدادات</button>
                        </div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <!-- Bottom Navigation للموبايل -->
    <nav class="bottom-nav">
        <a href="#" class="bottom-nav-item active" data-page="home">
            <span class="bottom-nav-icon">🏠</span>
            <span class="bottom-nav-label">الرئيسية</span>
        </a>
        <a href="#" class="bottom-nav-item" data-page="members">
            <span class="bottom-nav-icon">👥</span>
            <span class="bottom-nav-label">الأعضاء</span>
        </a>
        <a href="#" class="bottom-nav-item" data-page="merchants">
            <span class="bottom-nav-icon">🏪</span>
            <span class="bottom-nav-label">التجار</span>
        </a>
        <a href="#" class="bottom-nav-item" data-page="more" onclick="toggleMoreMenu(event)">
            <span class="bottom-nav-icon">☰</span>
            <span class="bottom-nav-label">المزيد</span>
        </a>
    </nav>

    <!-- قائمة المزيد -->
    <div class="more-menu" id="moreMenu">
        <div class="more-menu-header">
            <h3>المزيد</h3>
            <button onclick="closeMoreMenu()" class="close-btn">&times;</button>
        </div>
        <div class="more-menu-items">
            <a href="#" class="more-menu-item" data-page="transactions" onclick="goToPage('transactions')">
                <span>💳</span> العمليات
            </a>
            <a href="#" class="more-menu-item" data-page="commissions" onclick="goToPage('commissions')">
                <span>💰</span> العمولات
            </a>
            <a href="#" class="more-menu-item" data-page="disputes" onclick="goToPage('disputes')">
                <span>⚠️</span> الشكاوى
            </a>
            <a href="#" class="more-menu-item" data-page="support" onclick="goToPage('support')">
                <span>🎫</span> الدعم الفني
            </a>
            <a href="#" class="more-menu-item" data-page="reports" onclick="goToPage('reports')">
                <span>📊</span> التقارير
            </a>
            <a href="#" class="more-menu-item" data-page="withdrawals" onclick="goToPage('withdrawals')">
                <span>💸</span> طلبات السحب
            </a>
            <a href="#" class="more-menu-item" data-page="settings" onclick="goToPage('settings')">
                <span>⚙️</span> الإعدادات
            </a>
            <a href="#" class="more-menu-item logout" onclick="logout()">
                <span>🚪</span> تسجيل الخروج
            </a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../shared/config/supabase.js"></script>
    <script src="../shared/components/logo.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/dashboard-extended.js"></script>
</body>

</html>